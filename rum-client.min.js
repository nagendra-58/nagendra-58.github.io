!function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e){var t=this,n=e.trackUrl,r=e.threshold,o=void 0===r?6e3:r,i=e.batchSize,a=void 0===i?50:i,u=e.excludeKeys,c=void 0===u?[]:u,d=e.excludeHosts,s=void 0===d?[]:d,l=e.includeHosts,f=void 0===l?[]:l,p=e.parserCb,h=e.filterCb,m=e.addAdditionalData;(this.queuedEntries=[],this.options={trackUrl:n,threshold:o,batchSize:a,excludeKeys:c,excludeHosts:s,includeHosts:f,parserCb:p,filterCb:h,addAdditionalData:m},"performance"in window)&&("PerformanceObserver"in window&&new PerformanceObserver(function(e,n){t.handleEntries(e.getEntries())}).observe({entryTypes:["resource"]}));console.log("Setting up setInterval to push track data"),this.intervalId=window.setInterval(function(){t.queuedEntries.length&&(t.sendToServer(),t.queuedEntries=[])},o),window.onload=function(){setTimeout(function(){t.handleEntries(performance.getEntriesByType("navigation"))},0)}}return e.computeMetrics=function(e){return e.dnsTime=e.domainLookupEnd-e.domainLookupStart,e.connectionTime=e.connectEnd-e.connectStart,e.secureConnectionStart>0&&(e.tlsTime=e.connectEnd-e.secureConnectionStart),e.ttfb=e.responseStart-e.requestStart,e.fetchTime=e.responseEnd-e.fetchStart,e.workerStart>0&&(e.workerTime=e.responseEnd-e.workerStart),e.totalTime=e.responseEnd-e.requestStart,e.downloadTime=e.responseEnd-e.responseStart,e.headerSize=e.transferSize-e.encodedBodySize,e.compressionRatio=e.decodedBodySize/e.encodedBodySize,"navigation"===e.entryType&&(e.DOMContentLoadTime=e.domContentLoadedEventEnd-e.startTime,e.pageLoadTime=e.loadEventEnd-e.startTime),e},e.chunk=function(e,t){return e.reduce(function(e,n,r){return r%t==0&&e.push([]),e[e.length-1].push(n),e},[])},e.prototype.handleEntries=function(t){var n=this.options,r=n.trackUrl,o=n.excludeKeys,i=n.excludeHosts,a=n.includeHosts,u=n.parserCb,c=n.filterCb;t=(t=(t=t.map(function(e){return e.toJSON()})).filter(function(e){var t=-1===e.name.indexOf(r);return t=a.length>0?t&&a.some(function(t){return e.name.indexOf(t)>-1}):t&&!i.some(function(t){return e.name.indexOf(t)>-1})})).map(e.computeMetrics),u&&"function"==typeof u&&(t=t.map(u)),c&&"function"==typeof c&&(t=t.filter(c)),o.length&&(t=t.map(function(e){return Object.keys(e).reduce(function(t,n){return-1===o.indexOf(n)&&(t[n]=e[n]),t},{})})),this.queuedEntries=this.queuedEntries.concat(t)},e.prototype.sendToServer=function(){var t=this.options,n=t.batchSize,r=void 0===n?50:n,o=t.trackUrl,i=t.addAdditionalData,a=e.chunk(this.queuedEntries,r),u=Promise.resolve();a.forEach(function(e,t){u=u.then(function(){return new Promise(function(t,n){var r={data:e,additionalData:i()};fetch(o,{method:"post",headers:{Accept:"application/json, text/plain, */*","Content-Type":"application/json"},body:JSON.stringify(r)}).then(function(e){return e.json()}).then(function(e){return t()}).catch(function(e){return console.log("Error while sending data to /track: ",e,r),t()})})})})},e.prototype.stop=function(){clearInterval(this.intervalId),this.intervalId=0},e}();window.TrackPerformance=r,t.default=r}]);